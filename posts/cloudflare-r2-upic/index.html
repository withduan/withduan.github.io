<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.129.0">

  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://iduan.me/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://iduan.me/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://iduan.me/favicon-16x16.png">

  
  <link rel="manifest" href="https://iduan.me/site.webmanifest">

  
  <link rel="mask-icon" href="https://iduan.me/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">
  
  <script defer src="https://api.iduan.me/api.js" data-website-id="d366feff-1fcf-43b5-9f3b-8c42fd001987"></script>

  
  <link rel="stylesheet" href="https://iduan.me/css/bootstrap.min.css" />

  
  <title>åˆ©ç”¨ Cloudflare R2 &#43; uPic æ‰“é€ ç§äººå›¾åºŠ | JL DUANâ€˜s Blog</title>
  
  
  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

article img:not(.icon):not(.logo):not(.avatar):not(.inline-icon):not(.original-style) {
  max-width: 80%;
  max-height: 70vh;
  height: auto;
  display: block;
  margin: 1rem auto;
  border-radius: 8px;
  cursor: pointer;
}

img.original-style {
  max-width: 100%;
  max-height: none;
  height: auto;
  display: inline;
  margin: 0;
  border-radius: 0;
  box-shadow: none;
  cursor: default;
  transition: none;
}

img.original-style:hover {
  transform: none;
  box-shadow: none;
}

img.icon,
img.logo,
img.avatar,
img.inline-icon {
  max-width: none;
  max-height: none;
  height: auto;
  display: inline;
  margin: 0;
  border-radius: 0;
  box-shadow: none;
  cursor: default;
  transition: none;
}

img.icon:hover,
img.logo:hover,
img.avatar:hover,
img.inline-icon:hover {
  transform: none;
  box-shadow: none;
}

nav img,
footer img,
.navbar img {
  max-width: none;
  max-height: none;
  height: auto;
  display: inline;
  margin: 0;
  border-radius: 0;
  box-shadow: none;
  cursor: default;
  transition: none;
}

nav img:hover,
footer img:hover,
.navbar img:hover {
  transform: none;
  box-shadow: none;
}

.image-container {
  text-align: center;
  margin: 1.5rem 0;
}

img + em {
  display: block;
  text-align: center;
  font-style: italic;
  color: #666;
  font-size: 0.9rem;
  margin-top: 0.5rem;
}

h1 {
  font-size: 1.2rem;
  font-weight: 700;
  margin-top: 2rem;
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 3px solid #2563eb;
  line-height: 1.3;
}

article > h1:first-child {
  font-size: 1.4rem;
}

article > h4:first-child {
  font-size: 1.4rem;
}

.main-content h2 {
  font-size: 1.1rem;
  font-weight: 600;
  margin-top: 1.8rem;
  margin-bottom: 0.8rem;
  padding-bottom: 0.5rem;
  position: relative;
  line-height: 1.4;
  border-left: none;
  padding-left: 0;
  background: none;
}

.main-content h2::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 3px;
  background-color: #16a34a;
}

.main-content h3 {
  font-size: 1.05rem;
  font-weight: 600;
  margin-top: 1.5rem;
  margin-bottom: 0.6rem;
  padding-bottom: 0.5rem;
  position: relative;
  line-height: 1.4;
  background: none;
  border-radius: 0;
  padding-left: 0;
  padding-right: 0;
  padding-top: 0;
}

.main-content h3::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 3px;
  background-color: #dc2626;
}

.main-content h4 {
  font-size: 1rem;
  font-weight: 500;
  margin-top: 1.2rem;
  margin-bottom: 0.5rem;
  padding-bottom: 0.5rem;
  position: relative;
}

.main-content h4::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 3px;
  background-color: #f59e0b;
}

.main-content h5 {
  font-size: 0.95rem;
  font-weight: 500;
  margin-top: 1rem;
  margin-bottom: 0.4rem;
  padding-bottom: 0.5rem;
  position: relative;
}

.main-content h5::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 3px;
  background-color: #8b5cf6;
}

.main-content h6 {
  font-size: 0.9rem;
  font-weight: 500;
  margin-top: 0.8rem;
  margin-bottom: 0.3rem;
  padding-bottom: 0.5rem;
  position: relative;
}

.main-content h6::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 3px;
  background-color: #ec4899;
}

h2 {
  font-size: 1.1rem;
  font-weight: 600;
  margin-top: 1.8rem;
  margin-bottom: 0.8rem;
  padding-left: 0.8rem;
  border-left: 4px solid #28a745;
  line-height: 1.4;
}

h3 {
  font-size: 1.05rem;
  font-weight: 600;
  margin-top: 1.5rem;
  margin-bottom: 0.6rem;
  padding: 0.3rem 0.6rem;
  background: linear-gradient(90deg, #e9ecef 0%, #f8f9fa 70%, transparent 100%);
  border-radius: 4px;
  line-height: 1.4;
}

h4 {
  font-size: 1rem;
  font-weight: 500;
  margin-top: 1.2rem;
  margin-bottom: 0.5rem;
}

h5 {
  font-size: 0.95rem;
  font-weight: 500;
  margin-top: 1rem;
  margin-bottom: 0.4rem;
}

h6 {
  font-size: 0.9rem;
  font-weight: 500;
  margin-top: 0.8rem;
  margin-bottom: 0.3rem;
}

body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 15px 20px;
  margin: 1.5rem 0;
  font-size: 1em;
  border-left: 4px solid #ff8c00;
  background-color: #fffbf0;
  border-radius: 4px;
}

blockquote p:last-child,
.blockquote p:last-child {
  margin-bottom: 0;
}

blockquote > *:last-child,
.blockquote > *:last-child {
  margin-bottom: 0;
}


.tags-container {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin: 1rem 0;
}

.tag-item {
  display: inline-block;
  margin-right: 0.5rem;
  margin-bottom: 0.5rem;
}

.tag-item a {
  text-decoration: none;
}

.tag-item code {
  background-color: #e9ecef;
  border: 1px solid #ced4da;
  border-radius: 4px;
  padding: 0.25rem 0.5rem;
  font-size: 0.875rem;
  text-transform: none !important;
}

.tag-item:hover code {
  background-color: #dee2e6;
  border-color: #adb5bd;
}

.tag-item small {
  color: #6c757d;
  margin-left: 0.25rem;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin: 1rem 0;
  font-size: 0.9rem;
}

table th,
table td {
  border: 1px solid #dee2e6;
  padding: 0.75rem;
  text-align: left;
  vertical-align: top;
}

table th {
  background-color: #f8f9fa;
  font-weight: 600;
  border-bottom: 2px solid #dee2e6;
}

table tbody tr:nth-child(even) {
  background-color: #f8f9fa;
}

table tbody tr:hover {
  background-color: #e9ecef;
}

@media (max-width: 768px) {
  table {
    font-size: 0.8rem;
  }
  
  table th,
  table td {
    padding: 0.5rem;
  }
}

* {
  scrollbar-width: thin;
  scrollbar-color: rgba(0, 0, 0, 0.2) transparent;
}

::-webkit-scrollbar {
  width: 8px !important;
  height: 8px !important;
}

::-webkit-scrollbar-track {
  background: transparent !important;
}

::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.2) !important;
  border-radius: 4px !important;
  transition: background 0.3s ease !important;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(0, 0, 0, 0.4) !important;
}

html, body, * {
  scrollbar-width: thin !important;
  scrollbar-color: rgba(0, 0, 0, 0.2) transparent !important;
}

body {
  overflow-y: overlay;
  overflow-x: auto;
}

pre {
  overflow-x: overlay;
}

.table-responsive {
  overflow-x: overlay;
}

div, article, section, main, aside, nav, header, footer {
  scrollbar-width: thin !important;
  scrollbar-color: rgba(0, 0, 0, 0.2) transparent !important;
}

article a[href*="douban.com"] {
  color: #28a745 !important;
}

.rss-icon {
  width: 16px;
  height: 16px;
  margin-right: 2px;
  vertical-align: text-bottom;
  display: inline-block;
}

.douban-icon {
  width: 16px;
  height: 16px;
  margin-right: 4px;
  vertical-align: text-bottom;
  display: inline-block;
}

html, body {
  height: 100%;
}

.page-wrapper {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.content-wrapper {
  flex: 1;
}

.custom-footer {
  margin-top: auto;
  padding: 18px 0;
  background-color: #212529;
  color: rgba(255,255,255,.75);
}

.custom-footer .container {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.custom-footer small {
  margin: 0;
}

.custom-footer a {
  color: rgba(255,255,255,.75);
  text-decoration: none;
}

.custom-footer a:hover,
.custom-footer a:focus {
  color: rgba(255,255,255,1);
  text-decoration: none;
}

.notbyai-icon {
  max-width: none;
  max-height: none;
  height: auto;
  display: inline;
  margin: 0;
  border-radius: 0;
  box-shadow: none;
  cursor: default;
  transition: none;
}

.douban-icon {
  width: 22px;
  height: 22px;
  margin-right: 4px;
  vertical-align: text-bottom;
  display: inline-block;
}

@media (max-width: 768px) {
  .custom-footer .container {
    flex-direction: column;
    gap: 10px;
    text-align: center;
  }
}
.content-with-toc {
  position: relative;
  max-width: 800px;
  margin: 0 auto;
}

.toc {
  background-color: #f8f9fa;
  border: 1px solid #dee2e6;
  border-radius: 0.375rem;
  padding: 1rem;
}

.toc h5 {
  margin-top: 0;
  margin-bottom: 0.5rem;
  color: #495057;
  font-size: 1rem;
}

.toc ul {
  margin-bottom: 0;
  padding-left: 1.5rem;
  font-size: 0.9rem;
  list-style: none;
}

.toc li {
  margin-bottom: 0.25rem;
}

.toc a {
  color: #007bff;
  text-decoration: none;
}

.toc a:hover {
  color: #0056b3;
  text-decoration: underline;
}

.toc .douban-icon {
  width: 1rem;
  height: 1rem;
  margin-right: 4px;
  vertical-align: text-bottom;
  display: inline-block;
}

@media (min-width: 1200px) {
  .toc-desktop {
    position: fixed;
    left: calc(50% + 400px + 2rem);
    top: calc(60px + 1em + 1rem);
    width: 280px;
    max-height: calc(100vh - 60px - 1em - 2rem);
    overflow-y: auto;
    z-index: 100;
  }
  
  .toc-mobile {
    display: none;
  }
  
  .main-content {
    width: 100%;
  }
}

@media (min-width: 992px) and (max-width: 1199px) {
  .toc-desktop {
    position: fixed;
    left: calc(50% + 400px + 1rem);
    top: calc(60px + 1em + 1rem);
    width: 250px;
    max-height: calc(100vh - 60px - 1em - 2rem);
    overflow-y: auto;
    z-index: 100;
  }
  
  .toc-mobile {
    display: none;
  }
  
  .main-content {
    width: 100%;
  }
}

@media (max-width: 991px) {
  .toc-desktop {
    display: none;
  }
  
  .toc-mobile {
    margin: 1.5rem 0;
  }
  
  .main-content {
    width: 100%;
  }
}

@media (max-width: 768px) and (max-width: 991px) {
  .toc-mobile {
    max-width: 300px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const images = document.querySelectorAll('article img:not(.icon):not(.logo):not(.avatar):not(.inline-icon):not(.original-style)');
  
  images.forEach(function(img) {
    img.addEventListener('click', function(e) {
      e.preventDefault();
      window.open(this.src, '_blank');
    });
  });
  
  const doubanLinks = document.querySelectorAll('article a[href*="douban.com"]');
  
  doubanLinks.forEach(function(link) {
    if (!link.querySelector('.douban-icon')) {
      const icon = document.createElement('img');
      icon.src = 'https://img.iduan.me/blog/douban.png';
      icon.className = 'douban-icon original-style';
      icon.alt = 'è±†ç“£';
      
      link.insertBefore(icon, link.firstChild);
    }
  });
  
  const rssLinks = document.querySelectorAll('nav a');
  
  rssLinks.forEach(function(link) {
    if (link.textContent.toLowerCase().includes('rss')) {
      if (!link.querySelector('.rss-icon')) {
        const icon = document.createElement('img');
        icon.src = 'https://img.iduan.me/rss.png';
        icon.className = 'rss-icon original-style';
        icon.alt = 'RSS';
        
        link.insertBefore(icon, link.firstChild);
      }
    }
  });
});
</script>
</style>
</head>


<body>
  <div class="page-wrapper">
    <div class="content-wrapper">
      <nav class="custom-navbar">
  <div class="container">
    <strong><span style="color:#FFFFFF;">JL DUANâ€˜s Blog  </span></strong><span style="color:#FFFFFF;">ä¸¨</span>
    
    <a href="/">
      
      
      æ–‡ç« 
    </a>
    
    <a href="/tags/">
      
      
      æ ‡ç­¾
    </a>
    
    <a href="/about/">
      
      
      å…³äº
    </a>
    
    <a href="/index.xml">
      
        <img src="https://img.iduan.me/rss.png" alt="RSS" class="rss-icon" />
      
      
      RSS
    </a>
    
  </div>
</nav>
      
      <div class="container">
        <article>
          
<h4>åˆ©ç”¨ Cloudflare R2 + uPic æ‰“é€ ç§äººå›¾åºŠ</h4>
2024/12/09


<code><a href="https://iduan.me/tags/blog">blog</a></code>

</br>
</br>


<div class="content-with-toc">
  
  <aside class="toc toc-mobile">
      <h5>ç›®å½•</h5>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#1å®‰è£…-upic">1.å®‰è£… uPic</a></li>
    <li><a href="#2é…ç½®-cloudflare-r2-æœåŠ¡">2.é…ç½® Cloudflare R2 æœåŠ¡</a>
      <ul>
        <li><a href="#21-å¼€é€š-r2-æœåŠ¡">2.1 å¼€é€š R2 æœåŠ¡</a></li>
        <li><a href="#22-åˆ›å»ºå­˜å‚¨æ¡¶">2.2 åˆ›å»ºå­˜å‚¨æ¡¶</a></li>
        <li><a href="#23-é…ç½®åŸŸå">2.3 é…ç½®åŸŸå</a></li>
        <li><a href="#24-åˆ›å»º-r2-api-ä»¤ç‰Œ">2.4 åˆ›å»º R2 API ä»¤ç‰Œ</a></li>
      </ul>
    </li>
    <li><a href="#3-åœ¨-upic-ä¸­é…ç½®è‡ªå»ºå›¾åºŠ">3 åœ¨ uPic ä¸­é…ç½®è‡ªå»ºå›¾åºŠ</a></li>
    <li><a href="#4è®¾ç½®-cors-ç­–ç•¥å¯é€‰">4.è®¾ç½® CORS ç­–ç•¥ï¼ˆå¯é€‰ï¼‰</a></li>
  </ul>
</nav>
  </aside>
  
  
  <div class="main-content">
    <p>æˆ‘çš„åšå®¢é‡Œæœ‰å¾ˆå¤šå›¾ç‰‡ï¼Œæ¯”å¦‚æœ¬ç«™è®¿é—®é‡ç¬¬ä¸€åçš„æ–‡ç« ã€Š<a href="https://iduan.me/posts/creating-certificate-for-ipa-signing/">åˆ©ç”¨ Apple ä¸ªäººå¼€å‘è€…è´¦æˆ·åˆ›å»ºå¯ç”¨äº ipa è‡ªç­¾åçš„è¯ä¹¦</a>ã€‹ä¸­ä½¿ç”¨å¤§é‡æˆªå›¾å¯¹æ“ä½œæ­¥éª¤è¿›è¡Œè¾…åŠ©è¯´æ˜ï¼Œæ–¹ä¾¿æˆ‘è¿™æ ·çš„å°ç™½ç”¨æˆ·ã€‚</p>
<p><em>ï¼ˆå¹¸å¥½å½“æ—¶æŠŠæ–‡ç« çš„å›¾ç‰‡ä¸Šä¼ åˆ°äº†å›¾åºŠï¼Œæ–¹ä¾¿è®¿å®¢æµè§ˆã€‚è¦æ˜¯å’Œã€Š<a href="https://iduan.me/posts/self-driving-tour-in-2024/">è‡ªé©¾æ¸¸è®°å½•ä¸¨ 2023ï¼Œæˆ‘åœ¨è·¯ä¸Š</a>ã€‹è¿™ç¯‡æ–‡ç« ä¸€æ ·æŠŠæ‰€æœ‰å›¾ç‰‡ç›´æ¥æ”¾ GitHubï¼ŒåŠ è½½é€Ÿåº¦å®Œå…¨éšç¼˜â€¦ç”šè‡³æœ‰éƒ¨åˆ†è®¿å®¢æ ¹æœ¬çœ‹ä¸åˆ°æ–‡ç« çš„é…å›¾ã€‚ï¼‰</em></p>
<p>Cloudflare R2 æ˜¯ä¸€ä¸ªç½‘ç»œå­˜å‚¨æœåŠ¡ï¼Œæä¾›å…è´¹ 10GB å­˜å‚¨ç©ºé—´ï¼Œå¹¶ä¸”è¿™ 10GB <strong>åªè®¡ç®—å­˜å‚¨ç©ºé—´å ç”¨ï¼Œä¸è®¡ç®—äº’è”ç½‘æµé‡</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥ç™½å«–è¿™ 10GB å­˜å‚¨ç©ºé—´ä¿å­˜å›¾ç‰‡ï¼Œä¹Ÿä¸ç”¨é¢å¤–æ”¯ä»˜äº§ç”Ÿçš„æµé‡è´¹ç”¨ï¼Œè¿™ä¸æ˜¯å¤©ç”Ÿçš„å›¾åºŠåœ£ä½“å—ï¼ Cloudflare åŠŸå¾·+1</p>
<p>è™½ç„¶ 10GB ç©ºé—´çœ‹ç€ä¸ç®—å¤§ï¼Œä½†æ˜¯ä¸€äº›æµè¡Œçš„å›¾åºŠæ¯”å¦‚ <a href="https://sm.ms">sm.ms</a> çš„å…è´¹è´¦æˆ·ä¹Ÿåªæä¾› 5GB ç©ºé—´è€Œå·²ã€‚å¦‚æœå•å¼ å›¾ç‰‡æŒ‰ 1MB è®¡ç®—ï¼Œè¿™ 10GB ç©ºé—´ä¹Ÿè¶³å¤Ÿå‚¨å­˜ 10000+ å¼ å›¾ç‰‡ï¼Œç”¨æ¥ç»™ä¸ªäººç½‘ç«™åšå›¾åºŠç»å¯¹è¶³å¤Ÿäº†ã€‚æˆ‘ç»‘å®šåŸŸåè¯•äº†ä¸€ä¸‹ï¼Œè®¿é—®é€Ÿåº¦ä¹Ÿè¿˜ä¸é”™ï¼ˆè‡³å°‘æ¯” GitHub å¿«å§ï¼‰ã€‚</p>
<h1 id="1å®‰è£…-upic">1.å®‰è£… uPic</h1>
<p>uPic æ˜¯ macOS ä¸Šçš„ä¸€ä¸ªå›¾åºŠä¸Šä¼ å·¥å…·ï¼Œè™½ç„¶è‡ªèº«ä¸æ”¯æŒç›´æ¥å°† Cloudflare R2 ä½œä¸ºå›¾åºŠä½¿ç”¨ï¼Œä½†é€šè¿‡å…¼å®¹çš„ Amazon S3 é…ç½®å³å¯æ·»åŠ å¯¹ Cloudflare R2 ç­‰ç¬¬ä¸‰æ–¹ OSS æœåŠ¡çš„æ”¯æŒã€‚</p>
<p>uPic å…è´¹ç‰ˆæ­¢æ­¥äº 0.21.1 ä¸å†æ›´æ–°ï¼Œå¯ä»¥åœ¨ GitHub release ä¸­ä¸‹è½½ã€‚Mac App Store ä¸­æä¾›æœ€æ–°ç‰ˆï¼Œä½†æ˜¯éœ€è¦ä»˜è´¹ã€‚æœ€æ–°ç‰ˆè™½ç„¶æ²¡æœ‰ç›´æ¥åœ¨ GitHub ä¸­æä¾›æ‰“åŒ…å¥½çš„ .dmg æ–‡ä»¶ï¼Œä¸è¿‡ uPic æœ¬èº«å¼€æºï¼ŒmacOS ç”¨æˆ·å¯ä»¥åœ¨ GitHub ä¸­æ‹‰å–æœ€æ–°çš„æºç åˆ°æœ¬åœ°ï¼Œç”¨ Xcode ç¼–è¯‘è¿è¡Œå°±å¥½ï¼ˆç¼–è¯‘ä¹‹å‰è¦æå‰å®‰è£… cocoapodsï¼Œå¦åˆ™ç¼–è¯‘ä¼šæŠ¥é”™ï¼Œå…·ä½“å®‰è£… cocoapods æµç¨‹ä¸å†èµ˜è¿°ï¼‰ã€‚</p>
<p>ä¸ºå°Šé‡è½¯ä»¶ä½œè€…ï¼Œæˆ‘æ— æ³•ç›´æ¥æä¾›æ‰“åŒ…å¥½çš„æœ€æ–°ç‰ˆ <code>.dmg</code> æ–‡ä»¶ï¼Œè¯·æœ‰éœ€æ±‚çš„æœ‹å‹åœ¨ Mac App Store ä¸­å®‰è£…æˆ–è€…è‡ªè¡Œä¸‹è½½ GitHub æºç ç¼–è¯‘ä½¿ç”¨ã€‚</p>
<p><strong>ä¸‹è½½åœ°å€ï¼š</strong></p>
<ul>
<li>GitHubï¼š<a href="https://github.com/gee1k/uPic">https://github.com/gee1k/uPic</a></li>
<li>Mac App Storeï¼š<a href="https://apps.apple.com/us/app/id1510718678">https://apps.apple.com/us/app/id1510718678</a></li>
</ul>
<h1 id="2é…ç½®-cloudflare-r2-æœåŠ¡">2.é…ç½® Cloudflare R2 æœåŠ¡</h1>
<h2 id="21-å¼€é€š-r2-æœåŠ¡">2.1 å¼€é€š R2 æœåŠ¡</h2>
<p>æ‰“å¼€ Cloudflare æ§åˆ¶å° <a href="https://dash.cloudflare.com">https://dash.cloudflare.com</a>ï¼Œé€‰æ‹©å·¦ä¾§åˆ—è¡¨ä¸­çš„ã€ŒR2 å¯¹è±¡å­˜å‚¨ã€ã€‚æ²¡æœ‰è´¦å·å°±å…ˆæ³¨å†Œï¼Œåˆæ¬¡ä½¿ç”¨ R2 éœ€è¦ç»‘å®šä¿¡ç”¨å¡ï¼Œåªè¦å­˜å‚¨æ–‡ä»¶ä¸è¶…è¿‡ 10GB å°±ä¸ä¼šæ‰£è´¹ã€‚</p>
<h2 id="22-åˆ›å»ºå­˜å‚¨æ¡¶">2.2 åˆ›å»ºå­˜å‚¨æ¡¶</h2>
<p>è®¾ç½®åç§°ã€ä½ç½®ã€å­˜å‚¨ç±»ï¼Œä½ç½®å°½å¯èƒ½é è¿‘ç½‘ç«™çš„ä¸»æµå®¢æˆ·ï¼Œä»¥æœ€å¤§åŒ–æé«˜å›¾åºŠçš„åŠ è½½é€Ÿåº¦ã€‚
<img src="https://img.iduan.me/blog/cloudflare-r2-upic-01.webp" alt="cloudflare-r2-upic-01">
1ï¸âƒ£ è®¾ç½®åç§°æ–¹ä¾¿è‡ªå·±è¯†åˆ«ï¼Œåªèƒ½ç”¨å°å†™è‹±æ–‡å­—æ¯ã€æ•°å­—ã€è¿å­—ç¬¦ï¼›
2ï¸âƒ£ é»˜è®¤é€‰æ‹©ã€Œè‡ªåŠ¨ã€ï¼›
3ï¸âƒ£ æ ¹æ®ç½‘ç«™çš„ä¸»æµè®¿å®¢é€‰æ‹©é€‚å½“ä½ç½®ï¼Œæˆ‘é€‰äº†ã€Œäºšå¤ªåœ°åŒºã€ï¼›
4ï¸âƒ£ é»˜è®¤é€‰æ‹©ã€Œæ ‡å‡†ã€ï¼›
5ï¸âƒ£ ç‚¹å‡»ã€Œåˆ›å»ºå‚¨å­˜æ¡¶ã€ã€‚</p>
<h2 id="23-é…ç½®åŸŸå">2.3 é…ç½®åŸŸå</h2>
<p>Cloudflare R2 é»˜è®¤ä¼šä¸ºæ¯ä¸ªå­˜å‚¨æ¡¶æä¾›ä¸€ä¸ª <code>r2.dev</code> å­åŸŸï¼Œä½†æ˜¯å®˜æ–¹ä¹Ÿä¸å»ºè®®ç”¨äºæ­£å¼ä½¿ç”¨åœºæ™¯ã€‚</p>
<blockquote>
<p>å¯ç”¨ <code>r2.dev</code> è®¿é—®æ—¶ï¼ŒInternet ä¸Šçš„ä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨å…¬å…± <code>r2.dev</code> URL æŸ¥çœ‹æ­¤å­˜å‚¨æ¡¶ä¸­çš„å¯¹è±¡ã€‚ä½†åœ¨ä½¿ç”¨æ—¶æœ‰é€Ÿç‡é™åˆ¶ï¼Œå› æ­¤ï¼Œä¸å»ºè®®ç”¨äºç”Ÿäº§ã€‚æ­¤å¤–ï¼Œè®¿é—®å’Œç¼“å­˜ç­‰ Cloudflare åŠŸèƒ½æ— æ³•å†ä½¿ç”¨ã€‚<a href="https://developers.cloudflare.com/r2/buckets/public-buckets/#managed-public-buckets-through-r2dev">äº†è§£æ›´å¤š</a></p>
</blockquote>
<p>å†µä¸”ï¼š</p>
<ul>
<li>è¿™ä¸ª <code>r2.dev</code> å­åŸŸååŠ èµ·æ¥å¤§çº¦æœ‰ 50 ä¸ªå­—ç¬¦ï¼Œå†åŠ ä¸Šå›¾ç‰‡è·¯å¾„ï¼Œè‡´ä½¿å®Œæ•´çš„å›¾ç‰‡è®¿é—®åœ°å€å¤ªé•¿ï¼Œä½¿ç”¨ä¸ä¾¿ï¼›</li>
<li><code>r2.dev</code> åŸŸåå¯èƒ½ä¼šå‡ºç°è®¿é—®é€Ÿåº¦ä¸ç¨³å®šçš„æƒ…å†µ ğŸŒš</li>
</ul>
<p>å› æ­¤ï¼Œä¸º R2 å­˜å‚¨æ¡¶ç»‘å®šè‡ªå®šä¹‰åŸŸåæ‰æ˜¯æœ€ä¼˜è§£ã€‚æƒ³å¿…å»ºä¸ªäººç½‘ç«™çš„æœ‹å‹åº”è¯¥éƒ½æœ‰åŸŸåï¼Œç”šè‡³æ‰‹é‡Œä¸æ­¢ä¸€ä¸ªåŸŸå ğŸ˜</p>
<p><img src="https://img.iduan.me/blog/cloudflare-r2-upic-02.webp" alt="cloudflare-r2-upic-02"></p>
<p>1ï¸âƒ£ ç‚¹å‡»å­˜å‚¨æ¡¶ã€Œtuchuangã€çš„è®¾ç½®ï¼›
2ï¸âƒ£ è¾“å…¥ä½ æƒ³è¦è®¾ç½®çš„åŸŸåï¼ˆéœ€è¦æå‰æ‰˜ç®¡è‡³ Cloudflareï¼‰ï¼›
3ï¸âƒ£ ç‚¹å‡»ã€Œç»§ç»­ã€ï¼ŒæŒ‰æç¤ºæ“ä½œã€‚ç»‘å®šæˆåŠŸåä¼šè‡ªåŠ¨é…ç½® SSL è¯ä¹¦ã€‚</p>
<p>R2 å­˜å‚¨æ¡¶ä»…æ”¯æŒç»‘å®šå½“å‰ Cloudflare å¸æˆ·ä¸Šæ‰˜ç®¡è‡³ Cloudflare DNS è¿›è¡Œç®¡ç†çš„åŸŸåã€‚å¦‚æœæ²¡æœ‰ç‰¹åˆ«çš„éœ€æ±‚ï¼Œå½“ä½ çš„åŸŸå NS è®°å½•ä¸åœ¨ Cloudflare DNS æ—¶ï¼Œå¯ä»¥å°è¯•åœ¨åŸŸåæ³¨å†Œå•†å¤„å°† nameserver ï¼ˆä¹Ÿç§°ä¸º NS è®°å½•ï¼‰è®¾ç½®ä¸º Cloudflare nameserverã€‚Cloudflare ä¼šå¤åˆ¶å½“å‰å·²å­˜åœ¨çš„ DNS è®°å½•ï¼ŒåŸºæœ¬ä¸ä¼šå½±å“è¯¸å¦‚åŸŸåé‚®ç®±ç­‰ç­‰çš„å…¶ä»–æœåŠ¡ã€‚</p>
<p>åªæœ‰ä¸€ä¸ªåŸŸåçš„æœ‹å‹æ¨èè®¾ç½®ä¸€ä¸ªäºŒçº§åŸŸåè§£æåˆ°å­˜å‚¨æ¡¶ï¼Œæ¯”å¦‚ <code>cdn.domain.com</code>ã€<code>pic.domain.com</code>ã€<code>static.domain.com</code>ï¼Œè¿™æ ·çœ‹èµ·æ¥è§„æ•´ã€æœ‰åºã€‚</p>
<p>å¦‚æœä½ ä¸æƒ³ç»™å›¾åºŠè®¾ç½®äºŒçº§åŸŸåï¼Œæˆ–è€…ä¸æ–¹ä¾¿ä¿®æ”¹åŸŸå nameserver è®°å½•ï¼ˆNS è®°å½•ï¼‰ï¼Œä¹Ÿå¯ä»¥éšä¾¿ç”³è¯·ä¸€ä¸ªä¾¿å®œçš„åŸŸåç”¨æ¥ç»‘å®šå­˜å‚¨æ¡¶ã€‚å› ä¸ºå›¾åºŠåŸŸåä¸€èˆ¬ä¸éœ€è¦åœ¨å‰å°å±•ç¤ºï¼Œé™¤éè®¿å®¢æŸ¥çœ‹ç½‘é¡µæºä»£ç æ‰ä¼šçœ‹åˆ°å›¾ç‰‡åœ°å€ï¼Œè¿™æ ·æ“ä½œé€šå¸¸ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå½±å“ã€‚</p>
<p>è€Œæˆ‘çš„åŸŸåæ­£å¥½æ‰˜ç®¡åœ¨ Cloudflareï¼Œè¾“å…¥æƒ³è¦çš„äºŒçº§åŸŸååï¼Œè‡ªåŠ¨æ·»åŠ äº† DNS è§£æè®°å½•ï¼Œä¸éœ€è¦è‡ªå·±æ‰‹åŠ¨é…ç½®ã€‚Cloudflare ä¼šè‡ªåŠ¨ä¸ºç»‘å®šå¥½çš„åŸŸåç­¾å‘ SSL è¯ä¹¦ï¼Œæ‰€ä»¥ä¹Ÿä¸ç”¨æ‹…å¿ƒåœ¨åšå®¢ä¸­æ’å…¥è·¨åŸŸçš„å›¾åºŠèµ„æºåæ–‡ç« é¡µä¼šæŠ¥é”™ã€‚</p>
<h2 id="24-åˆ›å»º-r2-api-ä»¤ç‰Œ">2.4 åˆ›å»º R2 API ä»¤ç‰Œ</h2>
<p>åœ¨ Cloudflare æ§åˆ¶å°ä¸­é€‰æ‹©å·¦ä¾§åˆ—è¡¨ä¸­çš„ã€ŒR2 å¯¹è±¡å­˜å‚¨ã€ï¼Œç‚¹å‡»å³ä¾§ã€Œç®¡ç† API ä»¤ç‰Œã€ï¼Œå†ç‚¹å‡»æ–°é¡µé¢å³ä¾§çš„ã€Œåˆ›å»º API ä»¤ç‰Œã€ã€‚
<img src="https://img.iduan.me/blog/cloudflare-r2-upic-04.webp" alt="cloudflare-r2-upic-04"></p>
<p><img src="https://img.iduan.me/blog/cloudflare-r2-upic-03.webp" alt="cloudflare-r2-upic-03"></p>
<p><img src="https://img.iduan.me/blog/cloudflare-r2-upic-05.webp" alt="cloudflare-r2-upic-05"></p>
<p>1ï¸âƒ£ è®¾ç½®ä»¤ç‰Œåç§°æ–¹ä¾¿è¯†åˆ«ï¼›
2ï¸âƒ£ æ­¤å¤„é€‰ä¸­ã€Œå¯¹è±¡è¯»å’Œå†™ã€ï¼›
3ï¸âƒ£ é€‰æ‹©ã€Œä»…åº”ç”¨äºç‰¹å®šå­˜å‚¨æ¡¶ã€ï¼›
4ï¸âƒ£ åœ¨ä¸‹æ‹‰åˆ—è¡¨é‡Œé€‰æ‹©ä¹‹å‰åˆ›å»ºå¥½çš„å­˜å‚¨æ¡¶ã€Œtuchuangã€ï¼›
5ï¸âƒ£ ç‚¹å‡»ã€Œåˆ›å»º API ä»¤ç‰Œã€ã€‚</p>
<h1 id="3-åœ¨-upic-ä¸­é…ç½®è‡ªå»ºå›¾åºŠ">3 åœ¨ uPic ä¸­é…ç½®è‡ªå»ºå›¾åºŠ</h1>
<p>åœ¨ Cloudflare ä¸­åˆ›å»ºå¥½ R2 API ä»¤ç‰Œåï¼Œé¡µé¢ä¸­ä¼šæä¾›å›¾åºŠæ‰€éœ€çš„å„é¡¹å‚æ•°ï¼Œæš‚æ—¶ä¸è¦å…³é—­ç½‘é¡µï¼Œå°†å‚æ•°å¤åˆ¶åˆ° uPic å¯¹åº”ä½ç½®ã€‚
<img src="https://img.iduan.me/blog/cloudflare-r2-upic-06.webp" alt="cloudflare-r2-upic-06"></p>
<p>1ï¸âƒ£ æ‰“å¼€ uPic è®¾ç½®ï¼ˆå±å¹•å³ä¸Šè§’æ‰¾ uPic çŠ¶æ€æ å›¾æ ‡ï¼‰ï¼Œç‚¹å‡»ã€Œå›¾åºŠã€ï¼›
2ï¸âƒ£ ç‚¹å‡»è®¾ç½®çª—å£å·¦ä¸‹è§’çš„ â• åŠ å·ï¼›
3ï¸âƒ£ é€‰æ‹© Amazon S3ï¼›
4ï¸âƒ£ å‹¾é€‰ã€Œè‡ªå®šä¹‰ã€ï¼›
5ï¸âƒ£ å°†ä»¤ç‰Œåˆ›å»ºé¡µé¢ç”Ÿæˆçš„ã€Œä¸º S3 å®¢æˆ·ç«¯ä½¿ç”¨ç®¡è¾–æƒåœ°ç‰¹å®šçš„ç»ˆç»“ç‚¹ã€å®Œæ•´åœ°å€å¤åˆ¶åˆ°è¿™é‡Œï¼›
6ï¸âƒ£ ç©ºé—´åç§°å¡«å­˜å‚¨æ¡¶çš„åç§°ï¼Œå’Œæ­¥éª¤ 2.2 çš„åç§°è¦ç›¸åŒï¼›
7ï¸âƒ£ ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©ã€Œbucket-owner-full-controlã€ï¼›
8ï¸âƒ£ å°†ä»¤ç‰Œåˆ›å»ºé¡µé¢ç”Ÿæˆçš„ã€Œè®¿é—®å¯†é’¥ IDã€å¤åˆ¶åˆ°è¿™é‡Œï¼›
9ï¸âƒ£ å°†ä»¤ç‰Œåˆ›å»ºé¡µé¢ç”Ÿæˆçš„ã€Œæœºå¯†è®¿é—®å¯†é’¥ã€å¤åˆ¶åˆ°è¿™é‡Œï¼›
ğŸ”Ÿ å¡«å†™æ­¥éª¤ 2.3 ä¸­ç»‘å®šçš„åŸŸåï¼ŒåŸŸåå‰è¦åŠ  <code>https://</code> ï¼›
1ï¸âƒ£1ï¸âƒ£ æ ¹æ®è‡ªå·±å–œå¥½ï¼ŒæŒ‰ç…§ä¸‹æ–¹çš„ç¤ºä¾‹è¿›è¡Œå¡«å†™ï¼Œä¹Ÿå¯ä»¥ä¸æ”¹ï¼›
1ï¸âƒ£2ï¸âƒ£ å¡«å¥½åç‚¹å‡»ã€ŒéªŒè¯ã€ï¼Œå‰é¢æ“ä½œæ²¡ä»€ä¹ˆé—®é¢˜ä¼šæç¤ºæˆåŠŸï¼›
1ï¸âƒ£3ï¸âƒ£ éªŒè¯æˆåŠŸç‚¹å‡»ã€Œä¿å­˜ã€ï¼›
1ï¸âƒ£4ï¸âƒ£ å®Œæˆ uPic å›¾åºŠé…ç½®åå¯ä»¥ç‚¹å‡»ç½‘é¡µå³ä¸‹è§’çš„ã€Œå®Œæˆã€ã€‚</p>
<p>æ­¤æ—¶å›¾åºŠå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼Œé€šè¿‡ uPic ä¸Šä¼ å›¾ç‰‡åä¼šè‡ªåŠ¨å¤åˆ¶å›¾ç‰‡åœ°å€ï¼Œå¯ä»¥åœ¨ uPic èœå•ä¸­é€‰æ‹©å›¾åºŠåœ°å€è¾“å‡ºæ ¼å¼ï¼ˆurl/html/markdown/ubbï¼‰ã€‚</p>
<h1 id="4è®¾ç½®-cors-ç­–ç•¥å¯é€‰">4.è®¾ç½® CORS ç­–ç•¥ï¼ˆå¯é€‰ï¼‰</h1>
<p>ä»€ä¹ˆæ˜¯ CORSï¼Ÿç»“åˆå½“å‰åœºæ™¯ï¼ŒæŒ‰é€šä¿—çš„è¯æ¥è¯´ï¼Œå°±æ˜¯åªå…è®¸ç‰¹å®šç½‘ç«™åŠ è½½å›¾åºŠçš„èµ„æºï¼Œåˆ«äººå³ä½¿åœ¨åˆ«å¤„å¼•ç”¨äº†è¿™ä¸ªå›¾ç‰‡åŸå§‹é“¾æ¥ï¼Œä¹Ÿæ— æ³•æ˜¾ç¤ºå‡ºå›¾ç‰‡ï¼Œæ­¤ä¸¾å¯ä»¥èŠ‚çº¦æœåŠ¡è¿è¡Œçš„æµé‡æˆæœ¬ã€‚</p>
<p>æ¯”å¦‚ï¼Œæˆ‘å¯ä»¥è®¾ç½®åªå…è®¸åšå®¢ <code>https://domain.com</code> ä¸­çš„é¡µé¢æ‰èƒ½åŠ è½½å›¾åºŠ <code>cdn.domain.com</code> ä¸­çš„å›¾ç‰‡æ–‡ä»¶ï¼Œå…¶ä»–äººå¦‚æœæƒ³åœ¨åˆ«å¤„å¼•ç”¨è¿™äº›å›¾ç‰‡ï¼Œé™¤éä¸‹è½½å›¾ç‰‡å¹¶ä¸Šä¼ åˆ°è‡ªå·±åˆ°æœåŠ¡å™¨ï¼Œç›´æ¥åœ¨å…¶ä»–ç½‘ç«™ä¸­å¼•ç”¨æˆ‘çš„å›¾åºŠé“¾æ¥æ˜¯æ— æ•ˆçš„ã€‚</p>
<p>å¦‚æœ Cloudflare R2 æŒ‰ç…§å®¹é‡+æµé‡è®¡è´¹ï¼ˆäº‹å®ä¸Šè¿™ç§è®¡è´¹æ–¹å¼åœ¨äº‘è®¡ç®—æœåŠ¡ä¸­ä¹Ÿå¾ˆå¸¸è§ï¼‰ï¼Œè¿™æ ·çš„é™åˆ¶æ— ç–‘èƒ½èŠ‚çº¦å›¾åºŠçš„è¿è¡Œæˆæœ¬ã€‚ä½†æ˜¯ R2 åªå¯¹å­˜å‚¨å®¹é‡è®¡è´¹ï¼ˆ10GB ä»¥å†…å…è´¹ï¼‰ï¼Œä¸æ”¶å–æµé‡è´¹ç”¨ï¼Œå†åŠ ä¸Šä¸ªäººç½‘ç«™é€šå¸¸è®¿é—®é‡ä¸å¤§ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªå¯é€‰æ­¥éª¤ã€‚</p>
<p>å¦‚æœä½ å¯¹è¿™æ–¹é¢çš„ä¿¡æ¯å¾ˆæ„Ÿå…´è¶£ï¼Œè¯·æµè§ˆ Cloudflare æä¾›çš„ <a href="https://developers.cloudflare.com/r2/buckets/cors/">CORS æ–‡æ¡£</a>è¿›è¡Œé…ç½®ã€‚æˆ‘è¯•ç€æŒ‰ç…§ç¤ºä¾‹ä»£ç ç»™å‡ºå›¾åºŠ CORS é…ç½®çš„å†™æ³•ï¼Œæ²¡æœ‰ç»è¿‡æµ‹è¯•ï¼Œä¸è¦å‚è€ƒã€‚ğŸ™…</p>
<p><img src="https://img.iduan.me/blog/cloudflare-r2-upic-08.webp" alt="cloudflare-r2-upic-08"></p>

    
    
    <script src="https://giscus.app/client.js"
            data-repo="withduan/withduan.github.io"
            data-repo-id="R_kgDOK8qrXQ"
            data-category="Announcements"
            data-category-id="DIC_kwDOK8qrXc4Cb8Hw"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="top"
            data-theme="light"
            data-lang="zh-CN"
            crossorigin="anonymous"
            async>
    </script>
    
  </div>
  
  
  <aside class="toc toc-desktop">
      <h5>ç›®å½•</h5>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#1å®‰è£…-upic">1.å®‰è£… uPic</a></li>
    <li><a href="#2é…ç½®-cloudflare-r2-æœåŠ¡">2.é…ç½® Cloudflare R2 æœåŠ¡</a>
      <ul>
        <li><a href="#21-å¼€é€š-r2-æœåŠ¡">2.1 å¼€é€š R2 æœåŠ¡</a></li>
        <li><a href="#22-åˆ›å»ºå­˜å‚¨æ¡¶">2.2 åˆ›å»ºå­˜å‚¨æ¡¶</a></li>
        <li><a href="#23-é…ç½®åŸŸå">2.3 é…ç½®åŸŸå</a></li>
        <li><a href="#24-åˆ›å»º-r2-api-ä»¤ç‰Œ">2.4 åˆ›å»º R2 API ä»¤ç‰Œ</a></li>
      </ul>
    </li>
    <li><a href="#3-åœ¨-upic-ä¸­é…ç½®è‡ªå»ºå›¾åºŠ">3 åœ¨ uPic ä¸­é…ç½®è‡ªå»ºå›¾åºŠ</a></li>
    <li><a href="#4è®¾ç½®-cors-ç­–ç•¥å¯é€‰">4.è®¾ç½® CORS ç­–ç•¥ï¼ˆå¯é€‰ï¼‰</a></li>
  </ul>
</nav>
  </aside>
  
</div>
        </article>
      </div>
    </div>
    <footer class="custom-footer">
  <div class="container">
    <small>
      Â© 2016-2025 JL DUANâ€˜s Blog.
      <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">BY-NC-SA 4.0</a>
    </small>
    <img src="https://img.iduan.me/notbyai.png" alt="not by AI" width="70" class="notbyai-icon" />
  </div>
</footer>

  </div>
  
  
</body>

</html>
