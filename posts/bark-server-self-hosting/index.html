<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.129.0">

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://iduan.me/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://iduan.me/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://iduan.me/favicon-16x16.png">

  
  <link rel="manifest" href="https://iduan.me/site.webmanifest">

  
  <link rel="mask-icon" href="https://iduan.me/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://iduan.me/css/bootstrap.min.css" />

  
  <title>è‡ªå»º Bark åç«¯æœåŠ¡ | JL DUANâ€˜s Blog</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
  <script defer src="https://api.iduan.me/script.js" data-website-id="8b779afd-11de-47d9-8369-48c6d253e5a0"></script>
</head>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-N12REPWFYD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-N12REPWFYD');
</script>

<body>
  <nav class="custom-navbar">
  <div class="container">
    <strong><span style="color:#FFFFFF;">JL DUANâ€˜s Blog  </span></strong><span style="color:#FFFFFF;">ä¸¨</span>
    
    <a href="/">æ–‡ç« </a>
    
    <a href="/tags/">tags</a>
    
    <a href="/about/">å…³äº</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h4>è‡ªå»º Bark åç«¯æœåŠ¡</h4>
2022/04/08


<code><a href="https://iduan.me/tags/bark">bark</a></code>


<code><a href="https://iduan.me/tags/bark-server">bark-server</a></code>


<code><a href="https://iduan.me/tags/self-hosting">self-hosting</a></code>

</br>
</br>
<p><a href="https://www.v2ex.com/t/467407">Bark</a> æ˜¯ä¸€æ¬¾å¯ä»¥ç»™ iPhone å‘é€è‡ªå®šä¹‰æ¨é€çš„æœåŠ¡ï¼Œä½ å¯ä»¥åˆ©ç”¨ Bark åšä¸€äº›æœ‰è¶£çš„äº‹æƒ…ï¼Œæ¯”å¦‚æˆ‘ä¹‹å‰åˆ†äº«çš„ï¼š<a href="https://sspai.com/post/71054">é…åˆ SmsForward è½¬å‘ Android è®¾å¤‡çš„çŸ­ä¿¡è‡³ iPhone</a>ã€‚Bark æœ¬èº«æä¾›åç«¯æœåŠ¡ï¼ŒåŒæ—¶ä¹Ÿå¼€æºäº†æœåŠ¡ç«¯ä»£ç ï¼Œä½ å¯ä»¥åˆ©ç”¨ docker è½»æ¾åœ¨æœåŠ¡å™¨ç«¯éƒ¨ç½²ç§æœ‰åŒ– Bark åç«¯æœåŠ¡ã€‚</p>
<p>ä¹‹å‰åœ¨åšå®¢æœ‰<a href="https://iduan.me/archives/4/">æåˆ°è¿‡</a>æˆ‘é—²ç½®äº†ä¸€ä¸ªè…¾è®¯äº‘è™šæ‹Ÿä¸»æœºï¼Œç”±äºåŸŸåå¤‡æ¡ˆçš„å…³ç³»ï¼Œç°åœ¨æ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚æˆ‘æƒ³ä¸å…¶é—²ç½®åœ¨é‚£é‡Œï¼Œä¸å¦‚æ‹¿æ¥åšç‚¹æœ‰è¶£çš„äº‹æƒ…ã€‚</p>
<p>æˆ‘æœ¬èº«å¯¹æœåŠ¡å™¨è¿™æ–¹é¢ä¸æ˜¯ç‰¹åˆ«äº†è§£ï¼Œçœ‹åˆ° Bark åç«¯åªæä¾›äº† docker è¿™ä¸€ç§éƒ¨ç½²æ–¹å¼ã€‚æœ¬æ¥å¯ä»¥åœ¨è…¾è®¯äº‘æœåŠ¡å™¨çš„ç®¡ç†é¢æ¿ä¸­ç›´æ¥é‡ç½®ç³»ç»Ÿé•œåƒä¸º dockerï¼Œè¿™æ—¶å¿½ç„¶æƒ³èµ·æ¥ï¼Œä¹‹å‰å»ºç«™ç»å¸¸è¦ç”¨åˆ°çš„å®å¡”é¢æ¿å°±å¯ä»¥å®‰è£… docker ç®¡ç†å™¨ï¼Œå®å¡”é¢æ¿é‡Œç¼–è¾‘æœåŠ¡å™¨é‡Œçš„æ–‡ä»¶ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ï¼Œæ‰€ä»¥å°±å…ˆå®‰è£…äº†å®å¡”é¢æ¿ï¼Œæ–¹ä¾¿æˆ‘åç»­è¿›è¡Œæ“ä½œã€‚</p>
<p>æŒ‰ç…§å®˜æ–¹çš„<a href="https://day.app/2018/06/bark-server-document/">æ•™ç¨‹</a>ï¼Œæˆ‘æˆåŠŸåœ°åœ¨æœåŠ¡å™¨ä¸­éƒ¨ç½²å¥½äº† Bark åç«¯æœåŠ¡ã€‚æœ¬æ¥æƒ³è§£æä¸€ä¸ªäºŒçº§åŸŸå<code>push.iduan.me</code>åœ¨è¿™å°æœåŠ¡å™¨ä¸Šï¼Œæ–¹ä¾¿é…ç½®ã€‚è°çŸ¥è§£æç”Ÿæ•ˆè¿˜æ²¡è¿‡ 10 åˆ†é’Ÿï¼Œå°±è¢«è…¾è®¯äº‘æ‹¦æˆªäº†ï¼Œç”±äºè¿™ä¸ªåŸŸåè¿˜æ²¡æœ‰å¤‡æ¡ˆï¼ŒæŒ‰ç…§ç›¸å…³æ³•å¾‹æ³•è§„çš„è¦æ±‚ï¼Œè§£ææ˜¯æ— æ³•ç”Ÿæ•ˆçš„ï¼Œå› æ­¤åœ¨é…ç½®åç«¯æœåŠ¡æ—¶ï¼Œåªèƒ½å¡«å†™ IP åœ°å€ï¼Œä¸è¿‡å½±å“ä¹Ÿä¸å¤§ï½</p>
<p>æœ€éº»çƒ¦çš„æ˜¯ç»™è¿™ä¸ªè‡ªå»ºçš„åç«¯æœåŠ¡æ·»åŠ  SSL æ”¯æŒï¼Œå®˜æ–¹æ•™ç¨‹åªæ˜¯é˜è¿°äº†æ€ä¹ˆéƒ¨ç½²æ”¯æŒ http è®¿é—®çš„åç«¯ï¼Œæ ¹æœ¬æ²¡æ SSL çš„äº‹æƒ…ã€‚ä»¥å‰åœ¨å®å¡”é¢æ¿é‡Œä¸ºç½‘ç«™å¼€å¯ https è®¿é—®çš„æ–¹æ³•åœ¨è¿™é‡Œå®Œå…¨è¡Œä¸é€šï¼Œä¸ºæ­¤åˆè€—è´¹å¤§é‡æ—¶é—´å»ç½‘ç»œä¸­æœç´¢ï¼Œç­‰è¿™å¥—åç«¯æœåŠ¡å½»åº•æå¥½çš„æ—¶å€™å·²ç»æ˜¯åŠå¤œä¸¤ç‚¹äº†â€¦â€¦</p>
<p>ä»¥ä¸‹æ˜¯æœåŠ¡æ­å»ºè¿‡ç¨‹ä¸­å¼€å¯ SSL çš„ä¸€ç‚¹ç‚¹ç¬”è®°ï¼š</p>
<h4 id="ä¸º-ip-åœ°å€ç”³è¯·-ssl-è¯ä¹¦">âœğŸ»ä¸º IP åœ°å€ç”³è¯· SSL è¯ä¹¦</h4>
<p>å¤§éƒ¨åˆ†äº‘æœåŠ¡å•†ä¸æ”¯æŒä¸º IP åœ°å€ç”³è¯· SSL è¯ä¹¦ï¼Œå¯ä»¥è®¿é—® <a href="https://zerossl.com/">ZeroSSL</a> ç”³è¯· IP åœ°å€çš„SSLè¯ä¹¦ï¼Œå…è´¹è´¦æˆ·ç”³è¯·çš„è¯ä¹¦æœ‰æ•ˆæœŸåªæœ‰ä¸‰ä¸ªæœˆï¼Œè€Œä¸”ä¸æ”¯æŒè‡ªåŠ¨ç»­ç­¾ã€‚</p>
<p>å°†ç­¾å‘çš„è¯ä¹¦ï¼ˆä¸¤ä¸ª<code>.crt</code>æ–‡ä»¶ï¼Œä¸€ä¸ª<code>.key</code>æ–‡ä»¶ï¼‰ä¸Šä¼ è‡³<code>/www/server/nginx/conf/cert</code>ç›®å½•ä¸‹ï¼ˆæ²¡æœ‰ cert æ–‡ä»¶å¤¹å°±æ–°å»ºä¸€ä¸ªï¼‰</p>
<h4 id="ä¸ºæœåŠ¡å™¨å¯ç”¨-ssl">âœğŸ»ä¸ºæœåŠ¡å™¨å¯ç”¨ SSL</h4>
<p>ä¿®æ”¹ <code>/www/server/nginx/conf</code> è·¯å¾„ä¸‹ <code>nginx.conf</code> é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre tabindex="0"><code>server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name 1.2.3.4;
    add_header Strict-Transport-Security &#34;max-age=31536000; includeSubdomains; preload&#34;;
    ssl_certificate cert/certificate.crt;
    ssl_certificate_key cert/private.key;
    ssl_session_timeout 1d;
    ssl_session_cache shared:SSL:50m;
    ssl_session_tickets off;
    ssl_protocols TLSv1.2;
    ssl_ciphers &#39;ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256&#39;;
    ssl_prefer_server_ciphers on;
    ssl_stapling on;
    ssl_stapling_verify on;
    ssl_trusted_certificate cert/ca_bundle.crt;
    location / {
       proxy_pass http://127.0.0.1:8080;
    }
</code></pre><p>æ³¨æ„ï¼š</p>
<ul>
<li>è¯·å°†ç¬¬4è¡Œä¸­çš„<code>1.2.3.4</code>ä¿®æ”¹ä¸ºæœåŠ¡å™¨ IP åœ°å€ï¼›</li>
<li><code>cert/certificate.crt</code>ã€<code>cert/private.key</code>å’Œ<code>cert/ca_bundle.crt</code>å‡ä¸ºç›¸å¯¹è·¯å¾„ä¸‹å­˜æ”¾çš„è¯ä¹¦æ–‡ä»¶ï¼Œç»å¯¹è·¯å¾„ä¸ºï¼š<code>/www/server/nginx/conf/cert</code></li>
</ul>
<h4 id="è§£å†³éƒ¨åˆ†-android-app-è¿æ¥-bark-åç«¯æœåŠ¡æ—¶æŠ¥é”™çš„é—®é¢˜">âœğŸ»è§£å†³éƒ¨åˆ† Android App è¿æ¥ Bark åç«¯æœåŠ¡æ—¶æŠ¥é”™çš„é—®é¢˜</h4>
<p>å¼€å¯ SSL ä¹‹åï¼Œåœ¨éƒ¨åˆ† Android åº”ç”¨å†…è®¿é—®æœåŠ¡å™¨åç«¯åœ°å€æ—¶å¯èƒ½ä¼šæŠ¥é”™â€œjava security cert.CertPathValidatorException: Trust anchor for certification path not foundâ€ï¼ŒåŸå› æ˜¯åç«¯æœåŠ¡åœ¨éƒ¨ç½² SSL æ—¶ç¼ºå°‘äº†ä¸­é—´è¯ä¹¦ã€‚</p>
<p>ä½ å¯ä»¥åˆ©ç”¨ <a href="https://www.myssl.cn/tools/downloadchain.html">https://www.myssl.cn/tools/downloadchain.html</a> è¿™ä¸ªå·¥å…·ï¼Œä½¿ç”¨å·²æœ‰çš„<code>cert/certificate.crt</code>æ–‡ä»¶å¿«é€Ÿç”Ÿæˆä¸­é—´è¯ä¹¦ï¼Œæœ€åä¼šå¾—åˆ°<code>chain.crt</code>è¿™ä¸ªæ–‡ä»¶ã€‚</p>
<p>ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€<code>certificate.crt</code>ï¼Œåœ¨æ‰€æœ‰ä»£ç åé¢ä¾æ¬¡æ·»åŠ <code>ca_bundle.crt</code>ã€<code>chain.crt</code>è¿™ä¸¤ä¸ªæ–‡ä»¶é‡Œçš„å†…å®¹ï¼Œæœ€åçš„æ•ˆæœåº”è¯¥æ˜¯è¿™æ ·çš„ï¼š</p>
<pre tabindex="0"><code>-----BEGIN CERTIFICATE-----
è¿™é‡Œæ˜¯ certificate.crt åŸæœ¬çš„æ‰€æœ‰å†…å®¹
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
è¿™é‡Œæ˜¯ ca_bundle.crt æ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
è¿™é‡Œæ˜¯ chain.crt æ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹
-----END CERTIFICATE-----
</code></pre><p>ä¿å­˜æ–‡ä»¶ï¼Œç”¨è¿™ä¸ªç¼–è¾‘ä¹‹åçš„<code>certificate.crt</code>æ–‡ä»¶æ›¿æ¢æœåŠ¡å™¨ä¸­ä¹‹å‰ä¸Šä¼ çš„çš„<code>certificate.crt</code>ï¼Œä¸ªåˆ«åº”ç”¨ä¸­æŠ¥é”™çš„é—®é¢˜å³å¯è§£å†³ã€‚</p>

<script src="https://giscus.app/client.js"
        data-repo="withduan/withduan.github.io"
        data-repo-id="R_kgDOK8qrXQ"
        data-category="Announcements"
        data-category-id="DIC_kwDOK8qrXc4Cb8Hw"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>
    </article>
  </div>
  <footer>

<p style="color:#999999">
<p style="text-align:center;">
<small>
Â©ï¸2016-2024 JL DUANâ€˜s Blog.
</br>
CC <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">BY-NC-SA 4.0</a>
</small>
</p>
</p>
</footer>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
</body>

</html>
